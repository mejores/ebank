<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="js/lib/bootstrap.min.css">
    <style>
        .red{
            background: #a30;
        }
        input.error{
            border: 2px solid #a10;
        }
        .error{
            color: #aa1100;

        }
       /* p.error{
            display: none;
        }*/
        .wrapper{
            /*background-color: rgba(135, 140, 140, 0.31);*/
            width: 80%;
            margin: 50px auto;
            line-height: 50px;

        }
        body{
            background-color: #2aabd2;
        }
        #content{
            background-color: rgba(240, 240, 240, 0.65);

            width: 500px;
            height:350px;
            margin: 0 auto;
            margin-top: 100px;
            padding-top: 10px;
        }
         #isExist{
        color:red;
        visibility:hidden;
        }
    </style>
    <title>注册--新司机银行</title>
<script src="js/lib/jquery-1.12.4.min.js"></script>
</head>
<body >
<div id="content">
<div class="wrapper">
<form name="loginForm" method="post" class="form-inline" >
    <div class="form-group">
        <h3>注册新用户</h3>
        <label>用&nbsp户&nbsp名：&nbsp</label>
        <input name="username"
               type="text"
               class="form-control" id="username"
               onblur="regBlur()" onfocus="regFocus()">
        <span style="visibility:hidden" id="warname" >该账号不存在</span> 
    </div>
    <div class="form-group">
        <label>密&nbsp&nbsp&nbsp&nbsp&nbsp码&nbsp&nbsp：</label>
        <input class="form-control" type="password" id="password">
        <span style="visibility:hidden" id="warpass" class="error">密码不能为空</span>
            
    </div>
    <div class="form-group">
        <label>确认密码：</label>
        <input class="form-control" type="password" id="repassword" >
        <span style="visibility:hidden" id="warrepass" class="error"> 两次密码不一致</span>
    </div><br>
    <div class="form-group">
        <button type="button" onclick="regi()" class="btn btn-primary" >注册</button>
    </div>
</form>
</div>
</div>

<script>
$(function(){
	
})
var isvalid="false";
//检测用户是否存在
function isExists(){
	var username=$("#username").val();
	if(username!=""){
		$.ajax({
			url:'IsExist.do',
			method:'post',
			data:{"toUsername":username},//要传回的数据
			dataType:'text',
			success:function(msg){
				if(msg=="fail"){
					isvalid="true"
					$("#warname").html("该账号可用");
					$("#warname").css("visibility","visible");
					$("#warname").css("color","green");
				}else{
					$("#warname").html("该账号已被占用");
					$("#warname").css("visibility","visible");
					$("#warname").css("color","red");
				}
			}
		}); 
	}
}

function checkUname(){
	var username=$("#username").val();
	if(username.trim().length<3||username.trim().length>15){
		$("#warname").html("用户名需3到15位");
		$("#warname").css("visibility","visible");
		$("#warname").css("color","red");
		return false;
	}
	return true;
}
function checkPassword(){
	var password=$("#password").val();
	if(password.trim().length<3||password.trim().length>15){
		$("#warpass").html("密码需3到15位");
		$("#warpass").css("visibility","visible");
		$("#warname").css("color","red");
		return false;
	}
	return true;
}

function checkRepassword(){
	var password=$("#password").val();
	var repassword=$("#repassword").val();
	if(password!=repassword){
		$("#warrepass").html("前后密码不一致");
		$("#warrepass").css("visibility","visible");
		$("#warrename").css("color","red");
		return false;
	}
	return true;
}

function regi(){
	alert("zhuce");
	if(checkUname()&&checkPassword()&&checkRepassword()){
		alert("gg")
		var username=$("#username").val().trim();
		var password=$("#password").val().trim();
		var param={"username":username,"password":password};
		alert(param);
		 $.post("Register.do",param,function(msg){
			if(msg=="success"){
				$("#warrepass").html("注册成功，请等待管理员审核");
				$("#warrepass").css("visibility","visible");
				$("#warrename").css("color","green");
			}
		}) 

	}
}


    
   /*  function register(){
    	alert("注册");
    } */
  //验证数据用户名是否存在
    function regBlur(){
    	isExists()
    }
    function regFocus(){
    	$("#warname").css("visibility","hidden"); 
    }
    
</script>
</body>
</html>